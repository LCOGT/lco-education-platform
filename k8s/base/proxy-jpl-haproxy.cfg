global
    lua-load /usr/local/etc/haproxy/cors.lua
    maxconn 4096
    log stdout format raw local0 info

defaults
    mode http
    timeout connect 5s
    timeout client 10s
    timeout server 10s
    timeout http-request 10s
    log global
    option httplog

frontend http-in
    bind *:8080
    use_backend jpl-api if { path_beg /api/horizons.api }
    http-request lua.cors "GET" "localhost:*,127.0.0.1:*" " "
    http-response lua.cors

backend jpl-api
    timeout queue 5s
    server s1 ssd.jpl.nasa.gov:443 ssl verify none maxconn 1
